<!DOCTYPE html>
<html lang="<?php echo $this->language; ?>">
<head>
<meta charset="<?php echo $this->charset; ?>">
<title><?php echo $this->title; ?> - Contao Open Source CMS <?php echo VERSION; ?></title>
<base href="<?php echo $this->base; ?>">
<link rel="stylesheet" href="<?php
  $objCombiner = new Combiner();
  $objCombiner->add('system/themes/'. $this->theme .'/basic.css');
  $objCombiner->add('system/themes/'. $this->theme .'/main.css');
  if ($this->be27) {
    $objCombiner->add('system/themes/'. $this->theme .'/be27.css');
  }
  echo $objCombiner->getCombinedFile();
?>" media="all">
<!--[if IE]><link rel="stylesheet" href="<?php echo TL_SCRIPT_URL; ?>system/themes/<?php echo $this->theme; ?>/iefixes.css" media="screen"><![endif]-->
<?php echo $this->stylesheets; ?>
<style media="screen">
body {
	background-image: none;
}
#container {
	  margin:0 auto;
	  padding:12px 0;
	  width:750px;
}
#main {
	left:0px;
	float:none;
	min-height: 0px;
}
#tl_helpBox {
  margin-left:-353px;
}
</style>
<script>
var CONTAO_THEME = '<?php echo $this->theme; ?>';
var CONTAO_COLLAPSE = '<?php echo $this->collapseNode; ?>';
var CONTAO_EXPAND = '<?php echo $this->expandNode; ?>';
var CONTAO_SCRIPT_URL = '<?php echo TL_SCRIPT_URL; ?>';
var REQUEST_TOKEN = '<?php echo REQUEST_TOKEN; ?>';
</script>
<script src="<?php
  $objCombiner = new Combiner();
  $objCombiner->add('plugins/mootools/' . MOOTOOLS . '/mootools-core.js', MOOTOOLS_CORE);
  $objCombiner->add('plugins/mootools/' . MOOTOOLS . '/mootools-more.js', MOOTOOLS_MORE);
  $objCombiner->add('contao/contao.js');
  $objCombiner->add('system/themes/'. $this->theme .'/hover.js');
  echo $objCombiner->getCombinedFile();
?>"></script>
<!--[if lt IE 9]><script src="<?php echo TL_PLUGINS_URL; ?>plugins/html5shim/html5-<?php echo HTML5SHIM; ?>.js"></script><![endif]-->
</head>
<body class="__ua__">

<div id="container">
<div id="main">

<h1 class="main_headline"><?php echo $this->headline; ?></h1>
<?php if ($this->error): ?>

<p class="tl_gerror"><?php echo $this->error; ?></p>
<?php endif; ?>
<?php echo $this->main; ?>

</div>

<div class="clear"></div>

</div>
<script>
window.addEvent('domready',function(){
	$('tl_buttons').getElement('a.header_new_folder').destroy();
	$('tl_buttons').set('html',$('tl_buttons').get('html').replace("&nbsp; :: &nbsp; ",''));
});

function insertFile(el)
{
	el = $(el);
	var parentInput = parent.document.getElement('input[name="<?php echo urldecode($this->Input->get('fld'));?>"]');
	var parentImg = parentInput.getParent().getElement('img.preview');

	var erg = el.get('href').match(/id=([^&]+)/);
	parentInput.value = erg[1];
	parentImg.set('title',erg[1]);

	// try to use preview image
	var imgs = el.getParent('li').getElements('img');
	for(var i=0;i<imgs.length;i++)
	{
		if(imgs[i] != null && imgs[i].get('src').indexOf('system/html') != -1)
		{
			parentImg.set('src',imgs[i].get('src'));
			parent.Mediabox.close();
			return false;
		}
	}

	// show a icon
	var ext = el.get('href').match(/id=[^\.]+\.([a-zA-Z0-9]+)/);
	if(ext == null)
	{
		// probably a folder has been choosen
		parentImg.set('src','system/modules/filepicker4ward/html/folder.png');
		parent.Mediabox.close();
	}
	else
	{
		// choose the icon for this filetype
		var imgFile = 'system/modules/filepicker4ward/html/icons/'+ext[1]+'.png';
		Asset.image(imgFile,{
			onLoad: function()
			{
				parentImg.set('src',imgFile);
				parent.Mediabox.close();
			},
			onError: function()
			{
				parentImg.set('src','system/modules/filepicker4ward/html/default.png');
				parent.Mediabox.close();
			}
		});
	}


	return false;
}
</script>
<?php if ($this->pageOffset): ?>

<script>
Backend.vScrollTo(<?php echo $this->pageOffset; ?>);
</script>
<?php setcookie('BE_PAGE_OFFSET', 0, 0, '/'); endif; ?>
<?php echo $this->mootools; ?>

</body>
</html>